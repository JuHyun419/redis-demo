### ==================== String ====================

### Set String
POST http://localhost:7002/api/v1/string
Content-Type: application/json

{
  "baseRequest": {
    "key": "user:1"
  },
  "value": "JuHyunasdsalkdjsalkdjsakljd"
}

### Get String
GET http://localhost:7002/api/v1/string?key=user:1

### Multi Set Strings
POST http://localhost:7002/api/v1/string/multi
Content-Type: application/json

{
  "baseRequest": {
    "key": "multi:user:1"
  },
  "names": ["Alice", "Bob", "Charlie", "Mike"]
}

### ==================== Sorted Set (기본) ====================

### Sorted Set - 멤버 추가 (게임 랭킹 예시)
POST http://localhost:7002/api/v1/sorted-set
Content-Type: application/json

{
  "baseRequest": {
    "key": "ranking:game1"
  },
  "memberId": "player1",
  "name": "Alice",
  "score": 1500
}

### Sorted Set - 멤버 추가 2
POST http://localhost:7002/api/v1/sorted-set
Content-Type: application/json

{
  "baseRequest": {
    "key": "ranking:game1"
  },
  "memberId": "player2",
  "name": "Bob",
  "score": 2300
}

### Sorted Set - 멤버 추가 3
POST http://localhost:7002/api/v1/sorted-set
Content-Type: application/json

{
  "baseRequest": {
    "key": "ranking:game1"
  },
  "memberId": "player3",
  "name": "Charlie",
  "score": 1800
}

### Sorted Set - 멤버 추가 4
POST http://localhost:7002/api/v1/sorted-set
Content-Type: application/json

{
  "baseRequest": {
    "key": "ranking:game1"
  },
  "memberId": "player4",
  "name": "David",
  "score": 3100
}

### Sorted Set - 멤버 추가 5
POST http://localhost:7002/api/v1/sorted-set
Content-Type: application/json

{
  "baseRequest": {
    "key": "ranking:game1"
  },
  "memberId": "player5",
  "name": "Eve",
  "score": 2750
}

### Sorted Set - 상위 3명 조회
GET http://localhost:7002/api/v1/sorted-set/top?key=ranking:game1&n=3

### Sorted Set - 점수 범위 조회 (1500 ~ 2500점)
GET http://localhost:7002/api/v1/sorted-set/range?key=ranking:game1&minScore=1500&maxScore=2500

### ==================== Sorted Set (심화) ====================

### 특정 멤버 순위 조회 (Alice의 순위)
GET http://localhost:7002/api/v1/sorted-set/rank?key=ranking:game1&memberId=player1&name=Alice&score=1500

### 특정 멤버 순위 조회 (David의 순위 - 1위 예상)
GET http://localhost:7002/api/v1/sorted-set/rank?key=ranking:game1&memberId=player4&name=David&score=3100

### 점수 증가 (Alice +500점)
PATCH http://localhost:7002/api/v1/sorted-set/score?key=ranking:game1&memberId=player1&name=Alice&currentScore=1500&delta=500

### 점수 감소 (David -1000점)
PATCH http://localhost:7002/api/v1/sorted-set/score?key=ranking:game1&memberId=player4&name=David&currentScore=3100&delta=-1000

### Sorted Set 통계 조회 (전체 멤버 수)
GET http://localhost:7002/api/v1/sorted-set/stats?key=ranking:game1

### 점수 범위 내 멤버 수 조회 (2000점 이상)
GET http://localhost:7002/api/v1/sorted-set/count?key=ranking:game1&minScore=2000&maxScore=10000

### 멤버 삭제 (Bob 삭제)
DELETE http://localhost:7002/api/v1/sorted-set?key=ranking:game1&memberId=player2&name=Bob&score=2300

### 삭제 후 전체 조회
GET http://localhost:7002/api/v1/sorted-set/top?key=ranking:game1&n=10

### ==================== Hash (기본) ====================

### Hash - 단일 필드 저장
POST http://localhost:7002/api/v1/hash
Content-Type: application/json

{
  "baseRequest": {
    "key": "user:100"
  },
  "field": "name",
  "value": "JuHyun"
}

### Hash - 단일 필드 저장 2
POST http://localhost:7002/api/v1/hash
Content-Type: application/json

{
  "baseRequest": {
    "key": "user:100"
  },
  "field": "email",
  "value": "juhyun@example.com"
}

### Hash - 단일 필드 저장 3 (나이)
POST http://localhost:7002/api/v1/hash
Content-Type: application/json

{
  "baseRequest": {
    "key": "user:100"
  },
  "field": "age",
  "value": "28"
}

### Hash - 필드 조회
GET http://localhost:7002/api/v1/hash?key=user:100&field=name

### Hash - 사용자 프로필 저장 (객체)
POST http://localhost:7002/api/v1/hash/profile
Content-Type: application/json

{
  "baseRequest": {
    "key": "user:200"
  },
  "field": "profile",
  "profile": {
    "name": "Alice",
    "email": "alice@example.com",
    "age": 25
  }
}

### Hash - 사용자 프로필 조회
GET http://localhost:7002/api/v1/hash/profile?key=user:200&field=profile

### Hash - 필드 삭제
DELETE http://localhost:7002/api/v1/hash?key=user:100&fields=email

### ==================== Hash (심화) ====================

### Hash - 여러 필드 한번에 저장
POST http://localhost:7002/api/v1/hash/multi
Content-Type: application/json

{
  "baseRequest": {
    "key": "product:1"
  },
  "fields": [
    {"field": "name", "value": "MacBook Pro"},
    {"field": "price", "value": "2500000"},
    {"field": "stock", "value": "50"},
    {"field": "category", "value": "Electronics"}
  ]
}

### Hash - 전체 조회
GET http://localhost:7002/api/v1/hash/all?key=product:1

### Hash - 전체 조회 (user:100)
GET http://localhost:7002/api/v1/hash/all?key=user:100

### Hash - 통계 조회 (필드 개수, 필드 목록)
GET http://localhost:7002/api/v1/hash/stats?key=product:1

### Hash - 필드 존재 여부 확인
GET http://localhost:7002/api/v1/hash/exists?key=product:1&field=price

### Hash - 필드 존재 여부 확인 (없는 필드)
GET http://localhost:7002/api/v1/hash/exists?key=product:1&field=discount

### Hash - 숫자 필드 증가 (재고 +10)
PATCH http://localhost:7002/api/v1/hash/increment?key=product:1&field=stock&delta=10

### Hash - 숫자 필드 감소 (재고 -5)
PATCH http://localhost:7002/api/v1/hash/increment?key=product:1&field=stock&delta=-5

### Hash - 조회수 카운터 (없는 필드도 자동 생성됨)
PATCH http://localhost:7002/api/v1/hash/increment?key=product:1&field=viewCount&delta=1

### Hash - 변경 후 전체 조회
GET http://localhost:7002/api/v1/hash/all?key=product:1

### ==================== Strategy (Lua Script) ====================

### 1. 먼저 테스트용 키 2개 생성
POST http://localhost:7002/api/v1/string
Content-Type: application/json

{
  "baseRequest": {
    "key": "num:1"
  },
  "value": "100"
}

### 2. 두번째 키 생성
POST http://localhost:7002/api/v1/string
Content-Type: application/json

{
  "baseRequest": {
    "key": "num:2"
  },
  "value": "250"
}

### 3. Lua Script 실행 - 두 키의 값을 더해서 새 키에 저장
### num:1 (100) + num:2 (250) = num:result (350)
GET http://localhost:7002/api/v1/strategy/lua-script?key1=number_one&key2=number_two&newKey=newKey

### 4. 결과 확인
GET http://localhost:7002/api/v1/string?key=num:result

### ==================== Distributed Lock (분산락) ====================

### ===== 1. 테스트 준비 =====

### 1-1. 테스트용 상품 생성 (재고 100개)
POST http://localhost:7002/api/v1/lock/product
Content-Type: application/json

{
  "productId": "PRODUCT-001",
  "name": "아이폰 15 Pro",
  "stock": 100,
  "price": 1500000
}

### 1-2. 상품 조회
GET http://localhost:7002/api/v1/lock/product?productId=PRODUCT-001

### ===== 2. 개별 재고 차감 테스트 =====

### 2-1. 락 없이 재고 차감
POST http://localhost:7002/api/v1/lock/stock/decrease/no-lock?productId=PRODUCT-001&quantity=1

### 2-2. 분산락으로 재고 차감
POST http://localhost:7002/api/v1/lock/stock/decrease/with-lock?productId=PRODUCT-001&quantity=1

### 2-3. 차감 후 재고 확인
GET http://localhost:7002/api/v1/lock/product?productId=PRODUCT-001

### ===== 3. 동시성 테스트 (핵심!) =====

### 3-0. 테스트 전 상품 재생성 (재고 100개로 리셋)
POST http://localhost:7002/api/v1/lock/product
Content-Type: application/json

{
  "productId": "PRODUCT-001",
  "name": "아이폰 15 Pro",
  "stock": 100,
  "price": 1500000
}

### 3-1. 락 없이 동시성 테스트 (10개 동시 요청, 각 1개 차감)
### 예상: 재고 90개 / 실제: 91~99개 (동시성 문제 발생!)
POST http://localhost:7002/api/v1/lock/test/concurrency/no-lock
Content-Type: application/json

{
  "productId": "PRODUCT-001",
  "concurrentRequests": 10,
  "quantityPerRequest": 1
}

### 3-2. 테스트 후 재고 확인 (90이 아닐 수 있음!)
GET http://localhost:7002/api/v1/lock/product?productId=PRODUCT-001

### 3-3. 상품 재생성 (분산락 테스트를 위해)
POST http://localhost:7002/api/v1/lock/product
Content-Type: application/json

{
  "productId": "PRODUCT-001",
  "name": "아이폰 15 Pro",
  "stock": 100,
  "price": 1500000
}

### 3-4. 분산락으로 동시성 테스트 (10개 동시 요청, 각 1개 차감)
### 예상: 재고 90개 / 실제: 정확히 90개! ✅
POST http://localhost:7002/api/v1/lock/test/concurrency/with-lock
Content-Type: application/json

{
  "productId": "PRODUCT-001",
  "concurrentRequests": 10,
  "quantityPerRequest": 1
}

### 3-5. 테스트 후 재고 확인 (정확히 90!)
GET http://localhost:7002/api/v1/lock/product?productId=PRODUCT-001

### ===== 4. 대량 동시성 테스트 =====

### 4-1. 상품 재생성 (재고 1000개)
POST http://localhost:7002/api/v1/lock/product
Content-Type: application/json

{
  "productId": "PRODUCT-002",
  "name": "맥북 프로 16인치",
  "stock": 1000,
  "price": 3500000
}

### 4-2. 락 없이 100개 동시 요청 (심각한 문제 발생!)
POST http://localhost:7002/api/v1/lock/test/concurrency/no-lock
Content-Type: application/json

{
  "productId": "PRODUCT-002",
  "concurrentRequests": 100,
  "quantityPerRequest": 1
}

### 4-3. 상품 재생성
POST http://localhost:7002/api/v1/lock/product
Content-Type: application/json

{
  "productId": "PRODUCT-002",
  "name": "맥북 프로 16인치",
  "stock": 100000,
  "price": 3500000
}

### 4-4. 분산락으로 100개 동시 요청 (정상 동작!)
POST http://localhost:7002/api/v1/lock/test/concurrency/with-lock
Content-Type: application/json

{
  "productId": "PRODUCT-002",
  "concurrentRequests": 5000,
  "quantityPerRequest": 1
}

### ===== 5. Lua Script 동시성 테스트 (가장 빠름!) =====

### 5-1. 상품 재생성 (재고 10만개)
POST http://localhost:7002/api/v1/lock/product
Content-Type: application/json

{
  "productId": "PRODUCT-LUA",
  "name": "Lua 테스트 상품",
  "stock": 100000,
  "price": 1000000
}

### 5-2. Lua Script로 5000개 동시 요청 (빠르고 정확!)
POST http://localhost:7002/api/v1/lock/test/concurrency/lua
Content-Type: application/json

{
  "productId": "PRODUCT-LUA",
  "concurrentRequests": 5000,
  "quantityPerRequest": 1
}

### 5-3. 결과 확인
GET http://localhost:7002/api/v1/lock/product?productId=PRODUCT-LUA

### ===== 6. 성능 비교 테스트 =====

### 6-1. 상품 재생성
POST http://localhost:7002/api/v1/lock/product
Content-Type: application/json

{
  "productId": "PERF-TEST",
  "name": "성능 테스트 상품",
  "stock": 10000,
  "price": 1000000
}

### 6-2. 분산락 100개 요청 (느림)
POST http://localhost:7002/api/v1/lock/test/concurrency/with-lock
Content-Type: application/json

{
  "productId": "PERF-TEST",
  "concurrentRequests": 5000,
  "quantityPerRequest": 1
}

### 6-3. 상품 재생성
POST http://localhost:7002/api/v1/lock/product
Content-Type: application/json

{
  "productId": "PERF-TEST",
  "name": "성능 테스트 상품",
  "stock": 1000,
  "price": 1000000
}

### 6-4. Lua Script 100개 요청 (빠름!)
POST http://localhost:7002/api/v1/lock/test/concurrency/lua
Content-Type: application/json

{
  "productId": "PERF-TEST",
  "concurrentRequests": 1000,
  "quantityPerRequest": 1
}

### ===== 7. 락 상태 확인 =====

### 락 상태 확인
GET http://localhost:7002/api/v1/lock/status?key=stock:PRODUCT-001
